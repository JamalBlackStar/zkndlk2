<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>credit-card</title>
  <link rel="stylesheet" href="./style.css">

</head>
<body>
<!-- partial:index.partial.html -->
<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Поисковик законов</title>
<style>
:root {
  --bg:#0b0d10;
  --card:#12151a;
  --text:#e9eef5;
  --muted:#9fb0c3;
  --accent:#4ea1ff;
  --accent-border:#4ea1ff;
}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
  background:var(--bg);
  color:var(--text);
}
.wrap{max-width:920px;margin:0 auto;padding:24px}
h1{font-size:clamp(20px,3.5vw,32px);margin:0 0 10px}
.sub{color:var(--muted);margin-bottom:18px}
.searchBar{position:sticky;top:0;background:var(--bg);backdrop-filter: blur(8px); z-index:10; padding:12px 0 16px}
.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
input[type="text"]{flex:1;padding:14px 14px;border:1px solid var(--accent-border);border-radius:14px;color:var(--text);outline:none;background:var(--card);}
input::placeholder{color:#6a7a8b}
select{padding:10px;border-radius:10px;border:1px solid var(--accent-border);background:var(--card);color:var(--text);cursor:pointer}
.grid{display:grid;grid-template-columns:1fr;gap:12px;margin-top:16px}
@media(min-width:720px){.grid{grid-template-columns:1fr 1fr}}
.card{background:var(--card);border:1px solid var(--accent-border);border-radius:16px;padding:14px;box-shadow:0 8px 24px rgba(0,0,0,.15)}
.pill{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;border:1px solid var(--accent-border);background:none;font-size:12px;font-weight:700;cursor:default}
.btn{cursor:pointer;user-select:none}
.muted{color:var(--muted)}
.fine{font-weight:700}
.hl{background:rgba(78,161,255,.2); padding:0 .2em; border-radius:4px}
.nick{position:fixed;top:12px;left:12px;font-weight:700;color:var(--accent);font-size:16px;}
.nick a{color:var(--accent);text-decoration:none;}
.settingsBtn{
  position:fixed;top:12px;right:12px;padding:8px 12px;border-radius:10px;border:none;background:var(--accent);color:#001833;font-weight:700;cursor:pointer;z-index:20;
  transition: opacity 0.3s ease;
}
.settingsBtn.hidden{opacity:0;pointer-events:none;}
.settingsPanel{
  position:fixed;top:0;right:-300px;width:280px;height:100%;background:var(--card);
  box-shadow:-4px 0 20px rgba(0,0,0,.2);padding:16px;transition:right 0.3s ease, opacity 0.3s ease;z-index:21;opacity:0;
}
.settingsPanel.open{right:0;opacity:1;}
.settingsPanel h2{margin-top:0;font-size:18px;color:var(--text);}
.settingsPanel label{display:block;margin:12px 0 4px;color:var(--text);}
.settingsPanel select{width:100%;padding:6px 10px;border-radius:8px;border:1px solid var(--accent-border);background:var(--card);color:var(--text);}
.closePanel{position:absolute;top:12px;right:12px;background:none;border:none;color:var(--text);font-size:18px;cursor:pointer;}
.empty{border:1px dashed #334357;border-radius:14px;padding:14px;text-align:center;color:#9db0c6}

/* --- Минимальные стили вкладок и калькулятора (в твоём стиле) --- */
.tabs{display:flex;gap:8px;align-items:center;margin-bottom:8px;position:sticky;top:0;background:var(--bg);z-index:11;padding-top:8px}
.tabBtn{transition:transform .1s ease}
.tabBtn.active{background:rgba(78,161,255,.15)}
.tabBtn.btn{cursor:pointer}
.plus{line-height:1;padding:4px 10px}
.calcPanel{margin-top:16px}
.calcRow{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
.kpi{display:inline-flex;gap:6px;align-items:center}
.clearBtn{margin-left:auto}
</style>
</head>
<body>

<div class="nick"><a href="https://vk.com/mamedovka" target="_blank">By Jamal Mamedov</a></div>
<button class="settingsBtn" id="settingsBtn">⚙ Настройки</button>

<div class="settingsPanel" id="settingsPanel">
  <button class="closePanel" id="closePanel">&times;</button>
  <h2>Настройки</h2>
  <label for="themeSelect">Тема</label>
  <select id="themeSelect">
    <option value="dark">Тёмная</option>
    <option value="light">Светлая</option>
  </select>
  <label for="accentSelect">Цвет акцента</label>
  <select id="accentSelect">
    <option value="#4ea1ff">Синий</option>
    <option value="#00cfff">Голубой</option>
    <option value="#2be8a7">Мятный</option>
    <option value="#ff4e4e">Красный</option>
    <option value="#ff77cc">Розовый</option>
    <option value="#ffffff">Белый</option>
    <option value="#1c1c1c">Черный</option>
  </select>
</div>

<div class="wrap">

  <!-- Вкладки -->
  <div class="tabs">
    <div class="pill tabBtn btn active" data-target="section-main">Основное</div>
    <div class="pill tabBtn btn" data-target="section-calc">Калькулятор</div>
  </div>

  <!-- ====== ОСНОВНОЕ (НЕ ТРОГАЛ) ====== -->
  <section id="section-main">
    <div class="searchBar">
      <h1>Поисковик законов</h1>
      <div class="sub">Поиск по статьям КоАП РП и УК РП. Вводи ситуацию своими словами.</div>
      <div class="row">
        <input id="q" type="text" placeholder="Например: проезд на красный / без документов / превышение 40" />
        <select id="lawSelect">
          <option value="Все">Все</option>
          <option value="КоАП">КоАП РП</option>
          <option value="УК">УК РП</option>
        </select>
      </div>
    </div>
    <div id="results" class="grid"></div>
    <div id="empty" class="empty" style="display:none">Ничего не найдено.</div>
  </section>

  <!-- ====== КАЛЬКУЛЯТОР (НОВЫЙ, В ТВОЁМ СТИЛЕ) ====== -->
  <section id="section-calc" style="display:none">
    <div class="searchBar">
      <h1>Калькулятор штрафов</h1>
      <div class="sub">Выбирай нарушения, сумма штрафов — складывается, лишение — берём максимальный срок.</div>
      <div class="row">
        <input id="q2" type="text" placeholder="Ищи статьи для добавления (пример: опасное вождение, красный)" />
        <select id="lawSelect2">
          <option value="Все">Все</option>
          <option value="КоАП">КоАП РП</option>
          <option value="УК">УК РП</option>
        </select>
      </div>
    </div>
    <div id="results2" class="grid"></div>
    <div id="empty2" class="empty" style="display:none">Ничего не найдено.</div>

    <!-- Итоги калькулятора -->
    <div class="card calcPanel">
      <div class="calcRow">
        <div class="pill kpi">Выбрано: <span id="calc-count" class="fine">0</span></div>
        <div class="pill kpi">Штраф всего: <span id="calc-fine" class="fine">0 ₽</span></div>
        <div class="pill btn clearBtn" id="calc-clear">Очистить</div>
      </div>
      <div class="muted" id="calc-note" style="margin-top:10px;font-size:12px">
        Примечание: если в статье диапазон/«до», берём максимальное значение. «Предупреждение» считается как 0 ₽. Лишение суммарно не складывается — берём максимальный срок.
      </div>
    </div>
  </section>

</div>

<script>
// === Настройки ===
let theme = localStorage.getItem('theme') || 'dark';
let accent = localStorage.getItem('accent') || '#4ea1ff';
const applySettings = ()=>{
  const dark = theme==='dark';
  document.documentElement.style.setProperty('--bg', dark?'#0b0d10':'#f9f9f9');
  document.documentElement.style.setProperty('--card', dark?'#12151a':'#f1f3f6');
  document.documentElement.style.setProperty('--text', dark?'#e9eef5':'#1c1c1c');
  document.documentElement.style.setProperty('--muted', dark?'#9fb0c3':'#555');
  document.documentElement.style.setProperty('--accent', accent);
  document.documentElement.style.setProperty('--accent-border', accent);
  document.querySelectorAll('input[type="text"]').forEach(i=>{
    i.style.background = dark?'#12151a':'#fff';
    i.style.color = dark?'#e9eef5':'#1c1c1c';
  });
  document.querySelectorAll('.pill').forEach(p=>{
    p.style.borderColor = accent;
    p.style.color = dark?'#fff':'#000';
  });
};
applySettings();

const panel = document.getElementById('settingsPanel');
const settingsBtn = document.getElementById('settingsBtn');
settingsBtn.onclick = ()=>{ panel.classList.add('open'); settingsBtn.classList.add('hidden'); };
document.getElementById('closePanel').onclick = (e)=>{ e.stopPropagation(); panel.classList.remove('open'); settingsBtn.classList.remove('hidden'); };
document.addEventListener('click', e=>{
  if(!panel.contains(e.target) && e.target!==settingsBtn){
    panel.classList.remove('open'); settingsBtn.classList.remove('hidden');
  }
});
document.getElementById('themeSelect').value = theme;
document.getElementById('accentSelect').value = accent;
document.getElementById('themeSelect').onchange = e=>{ theme = e.target.value; localStorage.setItem('theme', theme); applySettings(); };
document.getElementById('accentSelect').onchange = e=>{ accent = e.target.value; localStorage.setItem('accent', accent); applySettings(); };

// === Подсветка ===
const norm = s => (s||"").toLowerCase().replace(/[ё]/g,'е').replace(/[^a-zA-Zа-яА-Я0-9+ ]+/g,' ').replace(/\s+/g,' ').trim();
function highlight(text, query){
  const q = norm(query).split(' ').filter(w=>w.length>2);
  if(!q.length) return text;
  let out = text;
  q.forEach(w=>{
    const re = new RegExp(`(${w.replace(/[.*+?^${}()|[\]\\]/g, "\\$&")})`,'gi');
    out = out.replace(re,'<span class="hl">$1</span>');
  });
  return out;
}

// === База данных (как у тебя — НЕ ТРОГАЛ) ===
const DB = [
  {gl:'4', art:'4.1', title:'Умышленное причинение вреда здоровью без летального исхода', law:'Умышленное причинение вреда здоровью человека без летального исхода.', fine:'Арест 1 год', tags:['вред','здоровье','без летального исхода'], lawCode:'УК'},
  {gl:'4', art:'4.2', title:'Особо тяжкие телесные повреждения с предсмертным исходом', law:'Умышленное нанесение особо тяжких телесных повреждений, по итогу которых человек был доведен до предсмертного положения.', fine:'Арест 2 года', tags:['тяжкие повреждения','предсмертное состояние'], lawCode:'УК'},
  {gl:'4', art:'4.2.1', title:'Особо тяжкие телесные повреждения двум и более лицам', law:'Умышленное нанесение особо тяжких телесных повреждений двум или более лицам.', fine:'Арест 4–6 лет', tags:['тяжкие повреждения','несколько жертв'], lawCode:'УК'},
  {gl:'4', art:'4.2.2', title:'Особо тяжкие телесные повреждения по неосторожности или в аффекте', law:'Нанесение особо тяжких телесных повреждений по неосторожности или совершенное в состоянии аффекта.', fine:'Арест до 2 лет', tags:['тяжкие повреждения','аффект','неосторожность'], lawCode:'УК'},
  {gl:'4', art:'4.3', title:'Угроза нанесения особо тяжких телесных повреждений', law:'Угроза нанесения особо тяжких телесных повреждений или причинения вреда здоровью человека.', fine:'Арест 1 год', tags:['угроза','здоровье'], lawCode:'УК'},
  {gl:'4', art:'4.4', title:'Похищение или незаконное лишение свободы', law:'Похищение гражданина, а также незаконное лишение человека свободы, не связанное с похищением.', fine:'Арест 4–6 лет', tags:['похищение','лишение свободы'], lawCode:'УК'},
  {gl:'4', art:'4.5', title:'Действия против половой неприкосновенности', law:'Любые действия, явно направленные против половой неприкосновенности и половой свободы личности.', fine:'Арест 3–6 лет', tags:['половая неприкосновенность','насилие'], lawCode:'УК'},
  {gl:'4', art:'4.6', title:'Незаконный сбор или распространение сведений о частной жизни', law:'Незаконный сбор или распространение сведений о частной жизни лица без его согласия.', fine:'Штраф 30.000 ₽ или арест 1 год', tags:['личная жизнь','конфиденциальность'], lawCode:'УК'},
  {gl:'5', art:'5.1', title:'Получение взятки', law:'Получение должностным лицом взятки в виде денег или имущества за незаконные действия.', fine:'Штраф 50%–150% от взятки или арест 3 года', tags:['взятка','должностное лицо'], lawCode:'УК'},
  {gl:'5', art:'5.2', title:'Дача взятки', law:'Дача взятки должностному лицу лично или через посредника, равно как и попытка дачи.', fine:'Арест 3 года', tags:['взятка','должностное лицо'], lawCode:'УК'},
  {gl:'5', art:'5.3', title:'Посягательство на жизнь и здоровье сотрудника власти', law:'Посягательство на жизнь и здоровье сотрудника полиции, военнослужащего или работника инкассации.', fine:'Арест 3–6 лет', tags:['насилие','сотрудник власти'], lawCode:'УК'},
  {gl:'5', art:'5.4', title:'Применение насилия к представителю власти', law:'Применение насилия или угроза его применения к представителю власти.', fine:'Арест до 3 лет', tags:['насилие','угроза','власть'], lawCode:'УК'},
  {gl:'5', art:'5.5', title:'Хамство к сотруднику правоохранительных органов', law:'Хамство, дерзость по отношению к сотруднику правоохранительных органов.', fine:'Штраф 15.000 ₽ или арест 1 год', tags:['хамство','полиция'], lawCode:'УК'},
  {gl:'5', art:'5.6', title:'Публичное оскорбление власти', law:'Публичное оскорбление или неоднократное проявление неуважения к представителям власти.', fine:'Штраф 25.000 ₽ или арест 2 года', tags:['оскорбление','власть'], lawCode:'УК'},
  {gl:'5', art:'5.7', title:'Провокационные действия против госструктур', law:'Провокационные действия против сотрудников госструктур или развлекательная деятельность с негативным характером.', fine:'Штраф 50.000 ₽ или арест до 2 лет', tags:['провокация','госструктуры'], lawCode:'УК'},
  {gl:'5', art:'5.7.1', title:'Преследование сотрудников правоохранительных органов', law:'Длительное преследование экипажа сотрудников правоохранительных органов и создание помех.', fine:'Штраф 50.000 ₽ или арест до 2 лет', tags:['преследование','полиция'], lawCode:'УК'},
  {gl:'5', art:'5.8', title:'Неоднократное неповиновение полиции', law:'Неоднократное неповиновение законному распоряжению или требованию служащего полиции.', fine:'Арест 2 года', tags:['неповиновение','полиция'], lawCode:'УК'},
  {gl:'5', art:'5.8.1', title:'Уход от полиции с нанесением ущерба', law:'Уход от полиции, сопутствующий нанесению ущерба имуществу.', fine:'Арест 3 года', tags:['уход','полиция','ущерб'], lawCode:'УК'},
  {gl:'5', art:'5.8.2', title:'Уход от полиции с причинением тяжкого вреда', law:'Уход от полиции с причинением телесных повреждений средней и выше тяжести по отношению к гражданскому лицу.', fine:'Арест 4 года', tags:['уход','тяжкий вред'], lawCode:'УК'},
  {gl:'5', art:'5.9', title:'Умышленное уничтожение имущества госорганов', law:'Умышленное уничтожение или повреждение имущества правоохранительных и государственных организаций.', fine:'Штраф 50.000 ₽ или арест 2 года', tags:['имущества','госорган'], lawCode:'УК'},
  {gl:'5', art:'5.10', title:'Ложный донос или ложные показания', law:'Заведомо ложный донос о совершении преступления или ложные свидетельские показания.', fine:'Штраф 25.000 ₽ или арест 2 года', tags:['ложь','донос','свидетель'], lawCode:'УК'},
  {gl:'5', art:'5.11', title:'Разглашение секретных данных', law:'Разглашение секретных данных или сведений о предстоящих операциях.', fine:'Арест до 3 лет', tags:['секретные данные','разглашение'], lawCode:'УК'},
  {gl:'5', art:'5.12', title:'Представление себя как служащего госоргана', law:'Представление себя в качестве служащего государственной организации, если это не соответствует действительности.', fine:'Штраф 30.000 ₽ или арест 1 год', tags:['самозванство','госорган'], lawCode:'УК'},
  {gl:'5', art:'5.13', title:'Халатность должностного лица', law:'Халатность, то есть неисполнение или ненадлежащее исполнение обязанностей должностным лицом, если это повлекло ущерб или нарушение прав.', fine:'Арест до 3 лет', tags:['халатность','должностное лицо'], lawCode:'УК'},
  {gl:'6', art:'6.1', title:'Терроризм', law:'Совершение взрыва, поджога или иных действий, устрашающих население и создающих опасность гибели человека.', fine:'Арест до 6 лет', tags:['терроризм','взрыв','поджог'], lawCode:'УК'},
  {gl:'6', art:'6.2', title:'Заведомо ложное сообщение о взрыве или поджоге', law:'Заведомо ложное сообщение о готовящихся взрыве, поджоге или иных опасных действиях.', fine:'Штраф 50.000 ₽ или арест 3 года', tags:['ложь','опасность'], lawCode:'УК'},
  {gl:'6', art:'6.3', title:'Захват или удержание заложника', law:'Захват или удержание лица в качестве заложника в целях принуждения.', fine:'Арест до 3 лет', tags:['заложник','принуждение'], lawCode:'УК'},
  {gl:'6', art:'6.4', title:'Организация массовых беспорядков', law:'Организация или участие в массовых беспорядках с насилием и разрушениями.', fine:'Штраф 100.000 ₽ и арест до 6 лет', tags:['беспорядки','массовые'], lawCode:'УК'},
  {gl:'6', art:'6.5', title:'Создание банды и участие в ней', law:'Создание группы людей в целях нападения на граждан или организации.', fine:'Арест до 6 лет', tags:['банда','нападение'], lawCode:'УК'},
  {gl:'6', art:'6.6', title:'Вандализм', law:'Осквернение зданий или порча имущества на общественном транспорте или в общественных местах.', fine:'Штраф 10.000 ₽ или арест 1 год', tags:['вандализм','имущество'], lawCode:'УК'},
  {gl:'6', art:'6.7', title:'Незаконное проникновение на частную территорию', law:'Незаконное проникновение в жилище или иной объект, против воли владельца.', fine:'Арест 2 года', tags:['проникновение','частная территория'], lawCode:'УК'},
  {gl:'6', art:'6.8', title:'Самовольное проникновение на охраняемый объект', law:'Самовольное проникновение на охраняемый объект.', fine:'Штраф 10.000 ₽ или арест 2 года', tags:['проникновение','охраняемый объект'], lawCode:'УК'},
  {gl:'6', art:'6.9', title:'Оружие и боеприпасы', law:'Приобретение, передача, сбыт, хранение, перевозка, продажа или ношение огнестрельного оружия, его частей и боеприпасов.', fine:'Штраф 20.000 ₽ или арест 3 года', tags:['оружие','боеприпасы'], lawCode:'УК'},
  {gl:'6', art:'6.10', title:'Незаконные наркотические средства', law:'Незаконные приобретение, хранение, перевозка, изготовление, переработка, продажа наркотических средств, психотропных веществ или аналогов.', fine:'Штраф 20.000 ₽ или арест 3 года', tags:['наркотики'], lawCode:'УК'},
  {gl:'6', art:'6.11', title:'Неоказание первой или медпомощи', law:'Неоказание первой или медицинской помощи лицом, обязанным это делать.', fine:'Арест 1 год', tags:['помощь','медицинская'], lawCode:'УК'},
  {gl:'6', art:'6.12', title:'Попытка срыва мероприятий', law:'Попытка срыва мероприятий группой лиц или намеренная помеха.', fine:'Арест 3 года', tags:['срыв','мероприятия'], lawCode:'УК'},
  {gl:'6', art:'6.13', title:'Использование незарегистрированной лицензии', law:'Использование или сбыт незарегистрированной лицензии или поддельного документа.', fine:'Штраф 20.000 ₽ или арест 3 года', tags:['лицензия','документ'], lawCode:'УК'},
  {gl:'6', art:'6.14', title:'Превышение должностных полномочий', law:'Превышение должностных полномочий, повлекшее нарушение прав и интересов граждан или организаций.', fine:'Штраф до 50.000 ₽ или арест до 3 лет', tags:['должностные полномочия'], lawCode:'УК'},
  {gl:'7', art:'7.1', title:'Мошенничество', law:'Хищение чужого имущества или приобретение права на чужое имущество путем обмана или злоупотребления доверием.', fine:'Штраф 50.000 ₽ + возмещение ущерба или арест 3 года', tags:['мошенничество','имущество'], lawCode:'УК'},
  {gl:'7', art:'7.2', title:'Грабеж или кража', law:'Грабеж или кража чужого имущества.', fine:'Арест 2 года', tags:['грабеж','кража'], lawCode:'УК'},
  {gl:'7', art:'7.3', title:'Вымогательство', law:'Требование передачи чужого имущества под угрозой насилия, уничтожения имущества, распространения позорящих сведений.', fine:'Арест 3 года', tags:['вымогательство','угроза'], lawCode:'УК'},
  {gl:'7', art:'7.4', title:'Умышленное уничтожение имущества', law:'Умышленные уничтожение или повреждение чужого имущества с причинением значительного ущерба.', fine:'Штраф 50.000 ₽ + возмещение ущерба или арест 2 года', tags:['имущество','ущерб'], lawCode:'УК'},
  {gl:'7', art:'7.5', title:'Организация азартных игр', law:'Организация и проведение азартных игр в общественных местах.', fine:'Штраф 50.000 ₽ или арест 2 года', tags:['азартные игры','общественное место'], lawCode:'УК'},

  /* --- КоАП РП (фрагмент из твоей базы) --- */
  {gl:'5', art:'5.1', title:'Управление без документов', law:'Управление ТС без документов (см. 2.1.1 ПДД).', fine:'20 000 ₽', tags:['документы','водитель','2.1.1'], syn:['нет документов','без документов','забыл права','нет страховки при себе','нет св-ва о регистрации при себе'], lawCode:'КоАП'},
  {gl:'5', art:'5.2', title:'Не предоставил документы по требованию', law:'Непредоставление документов по требованию (см. 2.1.1 ПДД).', fine:'30 000 ₽ или лишение (с переобучением)', tags:['документы','проверка'], syn:['не показал документы','отказ показать документы','не предоставил права'], lawCode:'КоАП'},
  {gl:'5', art:'5.3', title:'ТС не зарегистрировано / без знаков', law:'Управление незарегистрированным ТС либо без/с изменёнными знаками (см. 2.1.2 ПДД).', fine:'10 000 ₽', tags:['регистрация','знак','номера'], syn:['без номеров','скрытые номера','рамка скрывает номер','не успел поставить на учет'], lawCode:'КоАП'},
  {gl:'5', art:'5.4', title:'Тонировка ниже нормы', law:'Светопропускаемость < 70% на лобовом/передних стёклах (см. 2.4 ПДД).', fine:'20 000 ₽', tags:['тонировка','стекло'], syn:['тонировка','цветная пленка','темные стекла','низкая светопропускаемость'], lawCode:'КоАП'},
  {gl:'5', art:'5.5', title:'Технеисправное ТС / запрещающие условия', law:'Управление ТС при неисправности или в условиях, когда запрещено (см. 2.4 ПДД).', fine:'Предупреждение или 10 000–30 000 ₽', tags:['технеисправность'], syn:['лампа не горит','неисправность тормозов','трещина лобового','запрещено эксплуатацией',], lawCode:'КоАП'},
  {gl:'5', art:'5.6', title:'Без мотошлема (мото/мопед)', law:'Управление/перевозка без мотошлемов (см. 2.1.3 ПДД).', fine:'Предупреждение или 5 000 ₽', tags:['мото','шлем'], syn:['без шлема','пассажир без шлема'], lawCode:'КоАП'},
  {gl:'5', art:'5.7', title:'Нарушения пешеходов/велосипедистов', law:'Нарушение ПДД пешеходами и велосипедистами (глава 4 ПДД).', fine:'Предупреждение или 5 000–15 000 ₽', tags:['пешеход','велосипед'], syn:['пешеход нарушил','велосипедист нарушил'], lawCode:'КоАП'},
  {gl:'5', art:'5.8', title:'Посадка/высадка со стороны проезжей части', law:'Нарушение правил посадки/высадки (см. 5.1 ПДД).', fine:'Предупреждение или 5 000 ₽', tags:['посадка','высадка'], syn:['высадка на проезжей','открыл дверь на проезжую'], lawCode:'КоАП'},
  {gl:'5', art:'5.9', title:'Игнорирование требования остановиться жезлом', law:'Игнорирование требования об остановке (жезл).', fine:'20 000 ₽', tags:['остановка','жезл'], syn:['не остановился по требованию','проигнорировал жезл'], lawCode:'КоАП'},
  {gl:'5', art:'5.10', title:'Знаки/разметка: несоблюдение', law:'Несоблюдение требований знаков/разметки (прил. 1–2 ПДД).', fine:'5 000 ₽', tags:['знаки','разметка'], syn:['проехал под кирпич','нарушил разметку','знак запрета'], lawCode:'КоАП'},

  {gl:'6', art:'6.1', title:'Приоритет с маячками без уверенности в безопасности', law:'Использование приоритета с включёнными маячками/сиреной без уверенности в безопасности (см. 3.1 ПДД).', fine:'10 000 ₽', tags:['маячок','сирена'], syn:['маячки','спецсигналы'], lawCode:'КоАП'},
  {gl:'6', art:'6.2', title:'Аварийная сигнализация — нарушения', law:'Нарушение правил использования аварийной сигнализации (см. 7.1 ПДД).', fine:'Предупреждение или 10 000 ₽', tags:['аварийка'], lawCode:'КоАП'},
  {gl:'6', art:'6.3', title:'Знак аварийной остановки — нарушения', law:'Нарушение правил использования знака аварийной остановки (см. 7.2 ПДД).', fine:'Предупреждение или 10 000 ₽', tags:['аварийный знак'], lawCode:'КоАП'},
  {gl:'6', art:'6.4', title:'Движение с выключенными фарами', law:'Управление ТС с выключенными фарами (см. 8.1 ПДД).', fine:'Предупреждение или 5 000 ₽', tags:['фары','ближний свет'], syn:['без света','едет без фар'], lawCode:'КоАП'},
  {gl:'6', art:'6.5', title:'Неправомерное использование звукового сигнала', law:'Использование звукового сигнала с нарушением ПДД (см. 8.3 ПДД).', fine:'Предупреждение или 5 000 ₽', tags:['сигнал','клаксон'], syn:['гудел','сигналил'], lawCode:'КоАП'},

  {gl:'7', art:'7.1', title:'Проезд на запрещающий сигнал', law:'Красный сигнал/жест регулировщика/жёлтый при возможности остановки (см. 6.1 ПДД).', fine:'20 000 ₽', tags:['светофор','красный','регулировщик'], syn:['проехал на красный','запрещающийсигнал','на желтый'], lawCode:'КоАП'},
  {gl:'7', art:'7.2', title:'Не остановился перед стоп-линией', law:'Неисполнение требования остановки перед стоп-линией при запрещающем сигнале (см. 6.2 ПДД).', fine:'10 000 ₽', tags:['стоп-линия','светофор'], syn:['пересёк стоп линию','не остановился у стоп линии'], lawCode:'КоАП'},

  {gl:'8', art:'8.1', title:'Начало/перестроение/поворот без сигнала', law:'Манёвр без включения указателей поворота (см. 9.1 ПДД).', fine:'Предупреждение или 5 000 ₽', tags:['поворотник','манёвр'], syn:['без поворотника','не включил поворотник'], lawCode:'КоАП'},
  {gl:'8', art:'8.2', title:'Не уступил при перестроении', law:'Не предоставил преимущество при перестроении (см. 9.4 ПДД).', fine:'20 000 ₽', tags:['перестроение','преимущество'], lawCode:'КоАП'},
  {gl:'8', art:'8.3', title:'Поворот/разворот не из своей полосы', law:'Манёвр из неверной полосы (см. 9.4 ПДД).', fine:'20 000 ₽', tags:['полоса','поворот'], lawCode:'КоАП'},
  {gl:'8', art:'8.4', title:'Манёвр в нарушение знаков/разметки', law:'Поворот/разворот/задний ход в нарушение ПДД/знаков/разметки (см. 9.4, 9.4.1, 9.6, 9.7).', fine:'20 000 ₽', tags:['манёвр','разметка','знаки'], lawCode:'КоАП'},

  {gl:'9', art:'9.1', title:'Движение по встречной полосе', law:'Движение по встречной в нарушение ПДД (см. 10.1 ПДД).', fine:'50 000 ₽ + лишение до 2 лет', tags:['встречка'], lawCode:'КоАП'},
  {gl:'9', art:'9.2', title:'Выезд на встречную полосу', law:'Выезд на встречную в нарушение ПДД (см. 10.1 ПДД).', fine:'50 000 ₽', tags:['встречка','выезд'], lawCode:'КоАП'},
  {gl:'9', art:'9.3', title:'Левая полоса вне НП при свободных правых', law:'Движение по левым полосам при свободных правых (см. 10.2 ПДД).', fine:'Предупреждение или 5 000 ₽', tags:['полоса','вне НП'], lawCode:'КоАП'},
  {gl:'9', art:'9.4', title:'Движение по прерывистой в нарушение', law:'Движение по прерывистым линиям разметки с нарушением (см. 10.4 ПДД).', fine:'Предупреждение или 10 000 ₽', tags:['разметка'], lawCode:'КоАП'},
  {gl:'9', art:'9.5', title:'Движение по обочине/тротуару/газону', law:'Движение по разделительным полосам, обочинам, тротуарам, газону (см. 10.6 ПДД).', fine:'30 000 ₽', tags:['обочина','тротуар','газон'], lawCode:'КоАП'},
  {gl:'9', art:'9.6', title:'Дистанция/интервал не соблюдены', law:'Несоблюдение дистанции/бокового интервала (см. 10.8 ПДД).', fine:'Предупреждение или 10 000 ₽', tags:['дистанция','интервал'], lawCode:'КоАП'},

  {gl:'10', art:'10.1', title:'Обгон ТС со спецсигналами', law:'Обгон ТС со спецраскраской и включёнными маячками/сиреной (см. 3.2 ПДД).', fine:'20 000 ₽', tags:['обгон','спецсигналы'], lawCode:'КоАП'},
  {gl:'10', art:'10.2', title:'Обгон кортежа/сопровождения', law:'Обгон ТС со спецсигналами и сопровождаемых ТС (см. 3.2 ПДД).', fine:'20 000 ₽', tags:['обгон','сопровождение'], lawCode:'КоАП'},
  {gl:'10', art:'10.3', title:'Обгон там, где запрещён', law:'Обгон в запрещённых случаях (см. 12.2 ПДД).', fine:'20 000 ₽', tags:['обгон запрещён'], lawCode:'КоАП'},
  {gl:'10', art:'10.4', title:'Препятствование обгону', law:'Создание препятствий для обгоняющего (см. 12.3 ПДД).', fine:'20 000 ₽', tags:['обгон','препятствие'], lawCode:'КоАП'},

  {gl:'11', art:'11.1', title:'Остановка/стоянка на переходе/тротуаре', law:'На пешеходном переходе/ближе 5 м перед ним, на тротуаре (см. 13.3 ПДД).', fine:'10 000 ₽', tags:['остановка','переход','тротуар'], lawCode:'КоАП'},
  {gl:'11', art:'11.2', title:'Остановка у остановки ОТ', law:'В местах остановки маршрутных ТС/ближе 15 м (см. 13.3 ПДД).', fine:'10 000 ₽', tags:['остановка','общественный транспорт'], lawCode:'КоАП'},
  {gl:'11', art:'11.3', title:'Остановка на трамвайных путях/газоне/второй ряд', law:'На трамвайных путях, газоне, далее первого ряда (см. 13.3 ПДД).', fine:'10 000 ₽', tags:['трамвай','газон','второй ряд'], lawCode:'КоАП'},
  {gl:'11', art:'11.4', title:'Нарушение остановки — создал препятствие', law:'Нарушение остановки/стоянки с созданием препятствий (см. 13.3 ПДД).', fine:'10 000 ₽', tags:['препятствие'], lawCode:'КоАП'},
  {gl:'11', art:'11.5', title:'Иные нарушения остановки/стоянки', law:'Иные случаи нарушений остановки/стоянки (гл. 13 ПДД).', fine:'10 000 ₽', tags:['остановка','стоянка'], lawCode:'КоАП'},

  {gl:'12', art:'12.1', title:'Перекрёсток: безопасности', law:'Нарушения правил проезда перекрёстков (без опасности) (гл. 14 ПДД).', fine:'Предупреждение или 5 000 ₽', tags:['перекрёсток'], lawCode:'КоАП'},
  {gl:'12', art:'12.2', title:'Перекрёсток: с опасностью', law:'Нарушения правил проезда перекрёстков (с опасностью) (гл. 14 ПДД).', fine:'10 000 ₽', tags:['перекрёсток','опасность'], lawCode:'КоАП'},

  {gl:'13', art:'13.1', title:'Ж/д: пересечение вне мест', law:'Пересечение ж/д путей в не оборудованных местах (см. 16.1 ПДД).', fine:'Предупреждение или 5 000 ₽', tags:['жд','переезд'] , lawCode:'КоАП'},
  {gl:'13', art:'13.2', title:'Ж/д: выезд при запрете', law:'Выезд на переезд, когда это запрещено (см. 16.3 ПДД).', fine:'20 000 ₽', tags:['жд','запрещено'], lawCode:'КоАП'},
  {gl:'13', art:'13.3', title:'Ж/д: остановка ближе нормы', law:'Остановка ближе 5 м от шлагбаума / 10 м до рельса (см. 16.4 ПДД).', fine:'Предупреждение или 5 000 ₽', tags:['жд','остановка'], lawCode:'КоАП'},

  {gl:'14', art:'14.1', title:'Медленные ТС на автомагистрали', law:'Движение ТС < 40 км/ч по возможностям — на автомагистрали (см. 17.1 ПДД).', fine:'10 000 ₽', tags:['автомагистраль','скорость'], lawCode:'КоАП'},
  {gl:'14', art:'14.2', title:'Грузовым — далее второй полосы', law:'Грузовым далее второй полосы (см. 17.1 ПДД).', fine:'Предупреждение или 5 000 ₽', tags:['грузовой','полосы'], lawCode:'КоАП'},
  {gl:'14', art:'14.3', title:'Задний ход на автомагистрали', law:'Движение задним ходом на автомагистрали (см. 17.1 ПДД).', fine:'10 000 ₽', tags:['задний ход','автомагистраль'], lawCode:'КоАП'},
  {gl:'14', art:'14.4', title:'Пешеход мешает в жилой зоне', law:'Создание пешеходом помех в жилых зонах (см. 18.1 ПДД).', fine:'Предупреждение или 5 000 ₽', tags:['пешеход','жилая зона'], lawCode:'КоАП'},
  {gl:'14', art:'14.5', title:'Запреты в жилых зонах', law:'Сквозное движение/учебная езда/стоянка с работающим двигателем/груз. >3,5 т вне спец. мест (см. 18.2 ПДД).', fine:'Предупреждение или 5 000 ₽', tags:['жилая зона'], lawCode:'КоАП'},
  {gl:'14', art:'14.6', title:'Движение в колонне с нарушениями', law:'Нарушение правил движения в колонне (гл. 19 ПДД).', fine:'Предупреждение или 10 000 ₽', tags:['колонна'], lawCode:'КоАП'},

  {gl:'15', art:'15.1', title:'Не уступил спецтранспорту', law:'Не предоставил преимущество ТС с маячками/сиреной (см. 3.2 ПДД).', fine:'20 000 ₽', tags:['преимущество','спецсигналы'], lawCode:'КоАП'},
  {gl:'15', art:'15.2', title:'Не уступил автобусу/троллейбусу', law:'Не предоставил преимущество ОТ, начинающему движение (см. 20.2 ПДД).', fine:'5 000 ₽', tags:['преимущество','остановка ОТ'], lawCode:'КоАП'},
  {gl:'15', art:'15.3', title:'Не уступил главной / при выезде', law:'Не предоставил преимущество с главной дороги / при выезде (см. 9.3 ПДД).', fine:'10 000 ₽', tags:['главная','прилегающая'], lawCode:'КоАП'},
  {gl:'15', art:'15.4', title:'Не уступил пешеходу/велосипедисту', law:'Не предоставил преимущество пешим/велосипедистам (см. 15.1 ПДД).', fine:'Предупреждение или 5 000 ₽', tags:['пешеход','велосипед'], lawCode:'КоАП'},

  {gl:'16', art:'16.1', title:'Оставил место ДТП', law:'Оставление места ДТП (см. 2.4 ПДД).', fine:'30 000 ₽ + лишение 3–4 года + арест 20 суток', tags:['ДТП','оставил место'], lawCode:'КоАП'},
  {gl:'16', art:'16.2', title:'Не оказал первую помощь', law:'Неоказание первой помощи при ДТП (см. 2.3 ПДД).', fine:'20 000 ₽', tags:['первая помощь','ДТП'], lawCode:'КоАП'},
  {gl:'16', art:'16.3', title:'Не выполнил обязанности при ДТП', law:'Невыполнение обязанностей водителя при ДТП (см. 2.3 ПДД).', fine:'10 000–35 000 ₽', tags:['ДТП','обязанности'], lawCode:'КоАП'},

  {gl:'17', art:'17.1.4', title:'Управление в состоянии опьянения / передача управления пьяному', law:'Состояние опьянения (см. 2.4 ПДД).', fine:'30 000 ₽ + лишение до 1 года', tags:['опьянение'], lawCode:'КоАП'},
  {gl:'17', art:'17.1.5', title:'Отказ от медосвидетельствования', law:'Невыполнение требования пройти медосвидетельствование.', fine:'30 000 ₽ + лишение до 1 года', tags:['медосвидетельствование'], lawCode:'КоАП'},
  {gl:'17', art:'17.2', title:'Опасное вождение', law:'Опасное вождение (см. 2.4 ПДД).', fine:'до 30 000 ₽ + лишение до 2 лет', tags:['опасное вождение'], lawCode:'КоАП'},
  {gl:'17', art:'17.3', title:'Неуплата штрафов до 10 000 ₽', law:'Управление при неуплате штрафов до 10 000 ₽.', fine:'Предупреждение', tags:['штрафы'], lawCode:'КоАП'},
  {gl:'17', art:'17.4', title:'Неуплата штрафов 10–50 000 ₽', law:'Управление при неуплате штрафов 10–50 000 ₽.', fine:'30 000 ₽', tags:['штрафы'], lawCode:'КоАП'},
  {gl:'17', art:'17.5', title:'Неуплата штрафов 50–100 000 ₽', law:'Управление при неуплате штрафов 50–100 000 ₽.', fine:'50 000 ₽ + лишение 1 год', tags:['штрафы'], lawCode:'КоАП'},
  {gl:'17', art:'17.6', title:'Неуплата штрафов >100 000 ₽', law:'Управление при неуплате штрафов более 100 000 ₽.', fine:'100 000 ₽ + лишение 2 года', tags:['штрафы'], lawCode:'КоАП'},

  {gl:'18', art:'18.1', title:'Превышение на 10–20 км/ч', law:'Превышение скорости на 10–20 км/ч (зафиксировано сотрудниками).', fine:'Предупреждение', tags:['скорость'], lawCode:'КоАП'},
  {gl:'18', art:'18.2', title:'Превышение на 20–40 км/ч', law:'Превышение скорости на 20–40 км/ч.', fine:'2 000 ₽', tags:['скорость'], lawCode:'КоАП'},
  {gl:'18', art:'18.3', title:'Превышение на 40–60 км/ч', law:'Превышение скорости на 40–60 км/ч.', fine:'5 000 ₽', tags:['скорость'], lawCode:'КоАП'},
  {gl:'18', art:'18.4', title:'Превышение на 60–80 км/ч', law:'Превышение скорости на 60–80 км/ч.', fine:'7 000 ₽', tags:['скорость'], lawCode:'КоАП'},
  {gl:'18', art:'18.5', title:'Превышение 80+ км/ч', law:'Превышение скорости 80+ км/ч.', fine:'10 000 ₽ + лишение 1 год', tags:['скорость'], lawCode:'КоАП'},

  {gl:'19', art:'19.1', title:'Мелкое хулиганство', law:'Явное неуважение к обществу, нецензурная брань и пр.', fine:'до 10 000 ₽ или арест 10 суток', tags:['хулиганство'], lawCode:'КоАП'},
  {gl:'19', art:'19.2', title:'Оскорбление', law:'Оскорбление, унижение чести и достоинства.', fine:'до 10 000 ₽ или арест 10 суток', tags:['оскорбление'], lawCode:'КоАП'},
  {gl:'19', art:'19.3', title:'Побои (без УК)', law:'Побои/иные насильственные действия, без состава УК.', fine:'до 20 000 ₽ или арест 10 суток', tags:['побои'], lawCode:'КоАП'},
  {gl:'19', art:'19.4', title:'Распитие/появление в опьянении в общественных местах', law:'Алкоголь в общ. местах/появление в опьянении.', fine:'5 000 ₽', tags:['алкоголь','общественное место'], lawCode:'КоАП'},
  {gl:'19', art:'19.5', title:'Попрошайничество', law:'Занятие попрошайничеством в общественных местах.', fine:'Предупреждение или арест 10 суток', tags:['попрошайничество'], lawCode:'КоАП'},
  {gl:'19', art:'19.6', title:'Предпринимательство без регистрации/лицензии', law:'Деятельность без регистрации/лицензии при обязательности.', fine:'100 000 ₽', tags:['предпринимательство'], lawCode:'КоАП'}
];
DB.forEach(x=>{ x._hay = norm([x.title, x.law, (x.tags||[]).join(' '), (x.syn||[]).join(' ')].join(' ')); });

// === Поиск (ОСНОВНОЕ — БЕЗ ИЗМЕНЕНИЙ) ===
function score(item, q){
  const nq = norm(q);
  if(!nq) return 0;
  let s = 0;
  nq.split(' ').forEach(w=>{ if(w.length>2 && item._hay.includes(w)) s+=2; });
  (item.tags||[]).forEach(t=>{ if(nq.includes(norm(t))) s+=1; });
  (item.syn||[]).forEach(t=>{ if(nq.includes(norm(t))) s+=1.5; });
  if(item._hay.indexOf(nq)>=0) s+=3;
  return s;
}

function render(results, query){
  const box = document.getElementById('results');
  const empty = document.getElementById('empty');
  box.innerHTML = '';
  if(!results.length){ empty.style.display='block'; return; }
  empty.style.display='none';
  results.forEach(r=>{
    const el = document.createElement('div');
    el.className = 'card';
    el.innerHTML = `<div class="row" style="justify-content:space-between;align-items:flex-start;margin-bottom:6px">
        <div class="pill">${r.lawCode} · Глава ${r.gl} · Статья ${r.art}</div>
        <div class="pill">${r.lawCode === 'УК' ? 'Наказание' : 'Штраф'}: <span class="fine">${r.fine}</span></div>
      </div>
      <div style="font-weight:700;margin-bottom:6px">${highlight(r.title, query)}</div>
      <div class="muted">${highlight(r.law, query)}</div>
      ${r.tags?.length? `<div class="muted" style="margin-top:8px;font-size:12px">Теги: ${r.tags.map(t=>`#${t}`).join(' ')}</div>`:''}`;
    box.appendChild(el);
  });
}

function search(){
  const q = document.getElementById('q').value;
  const lawSel = document.getElementById('lawSelect').value;
  let dbFiltered = DB;
  if(lawSel !== 'Все') dbFiltered = DB.filter(x=>x.lawCode===lawSel);

  let results;
  if(!q.trim()) results = dbFiltered;
  else results = dbFiltered.map(x=>({...x, _s:score(x,q)})).filter(x=>x._s>0).sort((a,b)=>b._s - a._s);

  render(results, q);
}
const inp = document.getElementById('q');
let t;
inp.addEventListener('input', ()=>{ clearTimeout(t); t = setTimeout(search, 200); });
inp.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ e.preventDefault(); search(); }});
document.getElementById('lawSelect').addEventListener('change', search);

// Инициализация основного
search();

// === Вкладки ===
document.querySelectorAll('.tabBtn').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    document.querySelectorAll('.tabBtn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    const target = btn.dataset.target;
    document.querySelectorAll('section[id^="section-"]').forEach(s=>s.style.display = (s.id===target)?'block':'none');
  });
});

// === КАЛЬКУЛЯТОР ===

// Разделённый поиск для калькулятора (использует те же score/highlight/DB)
function renderCalc(results, query){
  const box = document.getElementById('results2');
  const empty = document.getElementById('empty2');
  box.innerHTML = '';
  if(!results.length){ empty.style.display='block'; return; }
  empty.style.display='none';

  results.forEach(r=>{
    const el = document.createElement('div');
    el.className = 'card';
    el.innerHTML = `<div class="row" style="justify-content:space-between;align-items:flex-start;margin-bottom:6px">
        <div class="pill">${r.lawCode} · Глава ${r.gl} · Статья ${r.art}</div>
        <div class="row" style="gap:8px">
          <div class="pill">${r.lawCode === 'УК' ? 'Наказание' : 'Штраф'}: <span class="fine">${r.fine}</span></div>
          <div class="pill btn plus" title="Добавить в расчёт">+</div>
        </div>
      </div>
      <div style="font-weight:700;margin-bottom:6px">${highlight(r.title, query)}</div>
      <div class="muted">${highlight(r.law, query)}</div>
      ${r.tags?.length? `<div class="muted" style="margin-top:8px;font-size:12px">Теги: ${r.tags.map(t=>`#${t}`).join(' ')}</div>`:''}`;
    // обработчик плюсика
    el.querySelector('.plus').addEventListener('click', ()=> addViolation(r));
    box.appendChild(el);
  });
}

function searchCalc(){
  const q = document.getElementById('q2').value;
  const lawSel = document.getElementById('lawSelect2').value;
  let dbFiltered = DB;
  if(lawSel !== 'Все') dbFiltered = DB.filter(x=>x.lawCode===lawSel);

  let results;
  if(!q.trim()) results = dbFiltered;
  else results = dbFiltered.map(x=>({...x, _s:score(x,q)})).filter(x=>x._s>0).sort((a,b)=>b._s - a._s);

  renderCalc(results, q);
}
const inp2 = document.getElementById('q2');
let t2;
inp2.addEventListener('input', ()=>{ clearTimeout(t2); t2 = setTimeout(searchCalc, 200); });
inp2.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ e.preventDefault(); searchCalc(); }});
document.getElementById('lawSelect2').addEventListener('change', searchCalc);

// Первичная инициализация калькулятора
searchCalc();

// === Логика подсчёта ===
let calcCount = 0;
let totalFine = 0;      // в ₽
let maxBanMonths = 0;   // лишение в месяцах

const moneyRe = /(\d[\d\s\u202F\u00A0]*)(?:[–—-](\d[\d\s\u202F\u00A0]*))?\s*₽/gim;
const banRe = /(лишен[^\d]{0,20}|лишение[^\d]{0,20}|до\s+)?(\d{1,3})(?:\s*[–—-]\s*(\d{1,3}))?\s*(год|года|лет|месяц|месяца|месяцев)/gim;

function toInt(s){ return parseInt((s||'').replace(/[^\d]/g,''),10) || 0; }
function formatRub(n){ return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,' ') + ' ₽'; }
function months(v, unit){
  if(/год|года|лет/i.test(unit)) return v*12;
  if(/месяц|месяца|месяцев/i.test(unit)) return v;
  return 0;
}

function extractPenalty(fineStr){
  if(!fineStr) return {fine:0, banMonths:0};

  // 1) Штраф: берём максимум из найденных сумм
  let m, maxFine = 0;
  const normStr = fineStr.replace(/руб(лей|\.|\b)/gi,'₽'); // подстрахуемся
  while((m = moneyRe.exec(normStr))!==null){
    const a = toInt(m[1]);
    const b = toInt(m[2]);
    maxFine = Math.max(maxFine, a, b);
  }
  // если нет денег, но есть "Предупреждение" — оставляем 0

  // 2) Лишение: берём максимум верхней границы/единственного значения
  let maxMonths = 0;
  while((m = banRe.exec(normStr))!==null){
    const a = toInt(m[2]);
    const b = toInt(m[3]);
    const unit = m[4]||'';
    const candidate = months(Math.max(a, b||0), unit);
    maxMonths = Math.max(maxMonths, candidate);
  }

  return {fine:maxFine, banMonths:maxMonths};
}

function addViolation(item){
  const {fine, banMonths} = extractPenalty(item.fine||'');
  calcCount += 1;
  totalFine += fine;
  maxBanMonths = Math.max(maxBanMonths, banMonths);
  updateCalcUI();
}

function resetCalc(){
  calcCount = 0;
  totalFine = 0;
  maxBanMonths = 0;
  updateCalcUI();
}

function prettyBan(monthsTotal){
  if(monthsTotal===0) return 'нет';
  if(monthsTotal%12===0) return (monthsTotal/12)+' год(а)';
  return monthsTotal+' мес.';
}

function updateCalcUI(){
  document.getElementById('calc-count').textContent = calcCount;
  document.getElementById('calc-fine').textContent = formatRub(totalFine);
  document.getElementById('calc-ban').textContent = prettyBan(maxBanMonths);
}
document.getElementById('calc-clear').addEventListener('click', resetCalc);
</script>

</body>
</html>
<!-- partial -->
  <script  src="./script.js"></script>

</body>
</html>
